<!-- match-filter.wxml - æ¯”èµ›ç­›é€‰ç»„ä»¶ -->
<view class="match-filter-container">
  <!-- ç­›é€‰å¤´éƒ¨ -->
  <view class="filter-header">
    <view class="filter-title">
      <text class="title-icon">ğŸ¾</text>
      <text class="title-text">æ¯”èµ›ç­›é€‰</text>
    </view>
    <view class="filter-actions">
      <text class="reset-btn" bindtap="resetFilters">é‡ç½®</text>
      <text class="close-btn" bindtap="closeFilter">âœ•</text>
    </view>
  </view>

  <!-- èµ›äº‹é¡¹ç›®ç­›é€‰ -->
  <view class="filter-section">
    <view class="section-title">
      <text class="section-icon">ğŸ†</text>
      <text class="section-text">èµ›äº‹é¡¹ç›®</text>
    </view>
    <view class="event-type-grid">
      <view 
        wx:for="{{eventTypes}}" 
        wx:key="id"
        class="event-type-item {{filters.eventType === item.id ? 'active' : ''}}"
        bindtap="selectEventType"
        data-type="{{item.id}}"
      >
        <view class="event-icon">{{item.icon}}</view>
        <text class="event-name">{{item.name}}</text>
        <text class="event-count">{{item.count}}åœº</text>
      </view>
    </view>
  </view>

  <!-- æ¯”èµ›çŠ¶æ€ç­›é€‰ -->
  <view class="filter-section">
    <view class="section-title">
      <text class="section-icon">âš¡</text>
      <text class="section-text">æ¯”èµ›çŠ¶æ€</text>
    </view>
    <view class="status-chips">
      <view 
        wx:for="{{statusOptions}}" 
        wx:key="id"
        class="status-chip {{filters.status === item.id ? 'active' : ''}}"
        bindtap="selectStatus"
        data-status="{{item.id}}"
      >
        <text class="chip-icon">{{item.icon}}</text>
        <text class="chip-text">{{item.name}}</text>
      </view>
    </view>
  </view>

  <!-- åœ°åŒºæœç´¢ -->
  <view class="filter-section">
    <view class="section-title">
      <text class="section-icon">ğŸ“</text>
      <text class="section-text">åœ°åŒº</text>
    </view>
    <region-search
      placeholder="æœç´¢åŸå¸‚æˆ–åœ°åŒº"
      showHotRegions="{{true}}"
      showRecentSearches="{{true}}"
      maxSuggestions="{{8}}"
      bindselect="onRegionSelect"
      bindclear="onRegionClear"
    />
  </view>

  <!-- æ—¶é—´é€‰æ‹© -->
  <view class="filter-section">
    <view class="section-title">
      <text class="section-icon">ğŸ“…</text>
      <text class="section-text">æ—¶é—´èŒƒå›´</text>
    </view>

    <!-- æ—¶é—´é€‰æ‹©è§¦å‘å™¨ -->
    <view class="time-selector" bindtap="showTimePicker">
      <view class="time-display">
        <text class="time-text">{{getTimeDisplayText()}}</text>
        <text class="time-icon">â°</text>
      </view>
    </view>
  </view>

  <!-- æ—¶é—´é€‰æ‹©å™¨ -->
  <time-picker
    visible="{{showTimePickerModal}}"
    showTimeRange="{{true}}"
    showDigitalTime="{{true}}"
    defaultStartDate="{{filters.startDate}}"
    defaultEndDate="{{filters.endDate}}"
    bindconfirm="onTimePickerConfirm"
    bindcancel="onTimePickerCancel"
  />

  <!-- é€‰æ‰‹æœç´¢ -->
  <view class="filter-section">
    <view class="section-title">
      <text class="section-icon">ğŸ‘¤</text>
      <text class="section-text">é€‰æ‰‹</text>
    </view>
    <view class="player-search">
      <input 
        class="player-input"
        placeholder="æœç´¢é€‰æ‰‹å§“å"
        value="{{filters.player}}"
        bindinput="onPlayerInput"
        bindconfirm="searchPlayer"
      />
      <view wx:if="{{playerSuggestions.length > 0}}" class="player-suggestions">
        <view 
          wx:for="{{playerSuggestions}}" 
          wx:key="id"
          class="player-suggestion"
          bindtap="selectPlayer"
          data-player="{{item.name}}"
        >
          <image class="player-avatar" src="{{item.avatar || '/images/default-avatar.png'}}" mode="aspectFill"/>
          <view class="player-info">
            <text class="player-name">{{item.name}}</text>
            <text class="player-rank">æ’å: {{item.ranking || 'N/A'}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- åº”ç”¨ç­›é€‰æŒ‰é’® -->
  <view class="filter-footer">
    <view class="results-count">
      <text class="count-text">æ‰¾åˆ° {{filteredCount}} åœºæ¯”èµ›</text>
    </view>
    <button class="apply-filter-btn" bindtap="applyFilters">
      <text class="btn-text">åº”ç”¨ç­›é€‰</text>
    </button>
  </view>
</view>

<!-- é®ç½©å±‚ -->
<view wx:if="{{showFilter}}" class="filter-mask" bindtap="closeFilter"></view>
