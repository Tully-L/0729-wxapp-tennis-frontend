<!-- score-detail.wxml - è¯¦ç»†æ¯”åˆ†æ˜¾ç¤ºç»„ä»¶ -->
<view class="score-detail-container">
  <!-- æ¯”èµ›çŠ¶æ€å¤´éƒ¨ -->
  <view class="match-status-header">
    <view class="status-indicator {{match.status === 'æ¯”èµ›ä¸­' ? 'live' : match.status === 'å·²ç»“æŸ' ? 'completed' : 'upcoming'}}">
      <text class="status-dot" wx:if="{{match.status === 'æ¯”èµ›ä¸­'}}"></text>
      <text class="status-text">{{getStatusText(match.status)}}</text>
    </view>
    <view class="match-format">{{match.format || 'ä¸‰ç›˜ä¸¤èƒœåˆ¶'}}</view>
  </view>

  <!-- é€‰æ‰‹ä¿¡æ¯ -->
  <view class="players-section">
    <!-- Team 1 -->
    <view class="team-info team1 {{scoreSummary && scoreSummary.winner === 'team1' ? 'winner' : ''}}">
      <view class="team-players">
        <view wx:for="{{match.players.team1}}" wx:key="name" class="player-item">
          <image class="player-avatar" src="{{item.avatar || '/images/default-avatar.png'}}" mode="aspectFill" />
          <view class="player-details">
            <text class="player-name">{{item.name}}</text>
            <text class="player-ranking" wx:if="{{item.ranking}}">æ’å: {{item.ranking}}</text>
          </view>
        </view>
      </view>
      <view class="team-label">{{getTeamLabel('team1')}}</view>
    </view>

    <!-- VS åˆ†éš”ç¬¦ -->
    <view class="vs-separator">
      <text class="vs-text">VS</text>
    </view>

    <!-- Team 2 -->
    <view class="team-info team2 {{scoreSummary && scoreSummary.winner === 'team2' ? 'winner' : ''}}">
      <view class="team-players">
        <view wx:for="{{match.players.team2}}" wx:key="name" class="player-item">
          <image class="player-avatar" src="{{item.avatar || '/images/default-avatar.png'}}" mode="aspectFill" />
          <view class="player-details">
            <text class="player-name">{{item.name}}</text>
            <text class="player-ranking" wx:if="{{item.ranking}}">æ’å: {{item.ranking}}</text>
          </view>
        </view>
      </view>
      <view class="team-label">{{getTeamLabel('team2')}}</view>
    </view>
  </view>

  <!-- è¯¦ç»†æ¯”åˆ†è¡¨æ ¼ -->
  <view class="score-table" wx:if="{{scoreSummary && scoreSummary.sets.length > 0}}">
    <view class="score-header">
      <view class="player-column">é€‰æ‰‹</view>
      <view wx:for="{{scoreSummary.sets}}" wx:key="setNumber" class="set-column">
        <text class="set-label">ç¬¬{{item.setNumber}}ç›˜</text>
      </view>
      <view class="total-column">æ€»ç›˜æ•°</view>
    </view>

    <!-- Team 1 æ¯”åˆ†è¡Œ -->
    <view class="score-row team1-row {{scoreSummary.winner === 'team1' ? 'winner-row' : ''}}">
      <view class="player-column">
        <text class="team-name">{{getTeamDisplayName('team1')}}</text>
      </view>
      <view wx:for="{{scoreSummary.sets}}" wx:key="setNumber" class="set-column">
        <view class="set-score-cell {{item.team1Score > item.team2Score ? 'set-winner' : ''}}">
          <text class="games-score">{{item.team1Score}}</text>
          <view wx:if="{{item.tiebreak && item.tiebreak.played}}" class="tiebreak-score">
            <text class="tiebreak-label">æŠ¢ä¸ƒ:</text>
            <text class="tiebreak-value">{{item.tiebreak.team1Score}}</text>
          </view>
        </view>
      </view>
      <view class="total-column">
        <text class="sets-won">{{getSetsWon('team1')}}</text>
      </view>
    </view>

    <!-- Team 2 æ¯”åˆ†è¡Œ -->
    <view class="score-row team2-row {{scoreSummary.winner === 'team2' ? 'winner-row' : ''}}">
      <view class="player-column">
        <text class="team-name">{{getTeamDisplayName('team2')}}</text>
      </view>
      <view wx:for="{{scoreSummary.sets}}" wx:key="setNumber" class="set-column">
        <view class="set-score-cell {{item.team2Score > item.team1Score ? 'set-winner' : ''}}">
          <text class="games-score">{{item.team2Score}}</text>
          <view wx:if="{{item.tiebreak && item.tiebreak.played}}" class="tiebreak-score">
            <text class="tiebreak-label">æŠ¢ä¸ƒ:</text>
            <text class="tiebreak-value">{{item.tiebreak.team2Score}}</text>
          </view>
        </view>
      </view>
      <view class="total-column">
        <text class="sets-won">{{getSetsWon('team2')}}</text>
      </view>
    </view>
  </view>

  <!-- å½“å‰å±€æ¯”åˆ†ï¼ˆè¿›è¡Œä¸­çš„æ¯”èµ›ï¼‰ -->
  <view class="current-game-score" wx:if="{{match.status === 'æ¯”èµ›ä¸­' && currentGameScore}}">
    <view class="current-game-header">
      <text class="current-game-title">å½“å‰å±€æ¯”åˆ†</text>
      <text class="current-set-info">ç¬¬{{currentGameScore.currentSet}}ç›˜ ç¬¬{{currentGameScore.currentGame}}å±€</text>
    </view>
    <view class="current-game-display">
      <view class="current-score-item">
        <text class="current-player">{{getTeamDisplayName('team1')}}</text>
        <text class="current-points">{{formatGameScore(currentGameScore.team1Points)}}</text>
      </view>
      <view class="current-score-separator">:</view>
      <view class="current-score-item">
        <text class="current-player">{{getTeamDisplayName('team2')}}</text>
        <text class="current-points">{{formatGameScore(currentGameScore.team2Points)}}</text>
      </view>
    </view>
    <view class="serving-indicator" wx:if="{{currentGameScore.servingTeam}}">
      <text class="serving-text">{{getTeamDisplayName(currentGameScore.servingTeam)}} å‘çƒ</text>
    </view>
  </view>

  <!-- æ¯”èµ›æœªå¼€å§‹çŠ¶æ€ -->
  <view class="no-score-state" wx:if="{{!scoreSummary || scoreSummary.sets.length === 0}}">
    <view class="no-score-icon">ğŸ¾</view>
    <text class="no-score-text">{{match.status === 'æŠ¥åä¸­' ? 'æ¯”èµ›å°šæœªå¼€å§‹' : 'æš‚æ— æ¯”åˆ†æ•°æ®'}}</text>
    <view class="match-time" wx:if="{{match.scheduledTime}}">
      <text class="time-label">é¢„è®¡å¼€å§‹æ—¶é—´:</text>
      <text class="time-value">{{formatDateTime(match.scheduledTime)}}</text>
    </view>
  </view>

  <!-- æ¯”èµ›ç»Ÿè®¡ä¿¡æ¯ -->
  <view class="match-stats-summary" wx:if="{{matchStats}}">
    <view class="stats-title">æ¯”èµ›ç»Ÿè®¡</view>
    <view class="stats-grid">
      <view class="stat-item" wx:if="{{matchStats.duration}}">
        <text class="stat-icon">â±ï¸</text>
        <text class="stat-label">æ¯”èµ›æ—¶é•¿</text>
        <text class="stat-value">{{matchStats.duration}}</text>
      </view>
      <view class="stat-item" wx:if="{{matchStats.totalGames}}">
        <text class="stat-icon">ğŸ¯</text>
        <text class="stat-label">æ€»å±€æ•°</text>
        <text class="stat-value">{{matchStats.totalGames}}</text>
      </view>
      <view class="stat-item" wx:if="{{matchStats.intensity}}">
        <text class="stat-icon">ğŸ”¥</text>
        <text class="stat-label">æ¯”èµ›å¼ºåº¦</text>
        <text class="stat-value intensity-{{matchStats.intensity}}">{{getIntensityText(matchStats.intensity)}}</text>
      </view>
    </view>
  </view>
</view>
