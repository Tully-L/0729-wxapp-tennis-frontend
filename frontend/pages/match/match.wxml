<!-- match.wxml - æ¯”èµ›é¡µé¢ -->
<view class="container">
  <!-- é¡µé¢å¤´éƒ¨å¯¼èˆª -->
  <view class="page-header">
    <view class="header-title">
      <text class="title-text">ç½‘çƒæ¯”èµ›</text>
      <text class="subtitle-text">Tennis Matches</text>
    </view>
    <view class="header-actions">
      <view class="search-btn" bindtap="showSearch">
        <text class="search-icon">ğŸ”</text>
      </view>
      <view class="filter-btn" bindtap="showAdvancedFilter">
        <text class="filter-icon">âš™ï¸</text>
        <view wx:if="{{activeFiltersCount > 0}}" class="filter-badge">{{activeFiltersCount}}</view>
      </view>
    </view>
  </view>

  <!-- ä¸»è¦å†…å®¹åŒºåŸŸ - å·¦å³åˆ†ç¦»å¸ƒå±€ -->
  <view class="main-content">
    <!-- å·¦ä¾§ï¼šæ¯”èµ›æ•°æ®åŒºåŸŸ -->
    <view class="match-data-section">
      <view class="section-header">
        <text class="section-title">æ¯”èµ›æ•°æ®</text>
        <text class="section-subtitle">Match Data</text>
      </view>

      <!-- æ¯”èµ›çŠ¶æ€æ ‡ç­¾é¡µ -->
      <view class="match-status-tabs">
        <view
          wx:for="{{matchStatusTabs}}"
          wx:key="id"
          class="status-tab {{activeMatchTab === item.id ? 'active' : ''}}"
          bindtap="switchMatchTab"
          data-tab="{{item.id}}"
        >
          <text class="tab-icon">{{item.icon}}</text>
          <text class="tab-text">{{item.name}}</text>
          <text wx:if="{{item.count > 0}}" class="tab-count">{{item.count}}</text>
        </view>
      </view>

      <!-- æ¯”èµ›æ•°æ®å†…å®¹ -->
      <view class="match-data-content">
        <!-- å·²æ¯”èµ›å’Œè¿›è¡Œä¸­çš„æ¯”èµ› -->
        <view wx:if="{{activeMatchTab === 'completed-ongoing'}}" class="completed-ongoing-matches">
          <!-- è¿›è¡Œä¸­çš„æ¯”èµ› -->
          <view wx:if="{{ongoingMatches.length > 0}}" class="ongoing-section">
            <view class="subsection-header">
              <text class="subsection-title">ğŸ”´ è¿›è¡Œä¸­</text>
              <text class="subsection-count">{{ongoingMatches.length}}</text>
            </view>
            <view class="matches-grid">
              <view
                wx:for="{{ongoingMatches}}"
                wx:key="id"
                class="match-card ongoing"
                bindtap="goToMatchDetail"
                data-id="{{item._id}}"
              >
                <view class="match-card-header">
                  <text class="match-type">{{item.eventType}}</text>
                  <view class="live-indicator">
                    <text class="live-dot"></text>
                    <text class="live-text">LIVE</text>
                  </view>
                </view>
                <view class="match-players">
                  <view class="player-row">
                    <text class="player-name">{{item.players.team1[0].name}}</text>
                    <text class="player-score">{{getTeamScore(item, 'team1')}}</text>
                  </view>
                  <view class="player-row">
                    <text class="player-name">{{item.players.team2[0].name}}</text>
                    <text class="player-score">{{getTeamScore(item, 'team2')}}</text>
                  </view>
                </view>
                <view class="match-info">
                  <text class="venue">{{item.venue}}</text>
                  <text class="time">{{formatMatchTime(item.scheduledTime)}}</text>
                </view>
              </view>
            </view>
          </view>

          <!-- å·²å®Œæˆçš„æ¯”èµ› -->
          <view wx:if="{{completedMatches.length > 0}}" class="completed-section">
            <view class="subsection-header">
              <text class="subsection-title">ğŸ† å·²å®Œæˆ</text>
              <text class="subsection-count">{{completedMatches.length}}</text>
            </view>
            <view class="matches-list">
              <view
                wx:for="{{completedMatches}}"
                wx:key="id"
                class="match-card completed"
                bindtap="goToMatchDetail"
                data-id="{{item._id}}"
              >
                <view class="match-card-header">
                  <text class="match-type">{{item.eventType}}</text>
                  <text class="match-duration">{{item.duration}}</text>
                </view>
                <view class="match-players">
                  <view class="player-row {{item.winnerId === item.players.team1[0].name ? 'winner' : ''}}">
                    <text class="player-name">{{item.players.team1[0].name}}</text>
                    <text class="player-score">{{getTeamScore(item, 'team1')}}</text>
                  </view>
                  <view class="player-row {{item.winnerId === item.players.team2[0].name ? 'winner' : ''}}">
                    <text class="player-name">{{item.players.team2[0].name}}</text>
                    <text class="player-score">{{getTeamScore(item, 'team2')}}</text>
                  </view>
                </view>
                <view class="match-info">
                  <text class="venue">{{item.venue}}</text>
                  <text class="date">{{formatMatchDate(item.scheduledTime)}}</text>
                </view>
              </view>
            </view>
          </view>
        </view>

        <!-- æœªæ¥çš„æ¯”èµ› -->
        <view wx:elif="{{activeMatchTab === 'upcoming'}}" class="upcoming-matches">
          <view wx:if="{{upcomingMatches.length > 0}}" class="upcoming-section">
            <view class="subsection-header">
              <text class="subsection-title">ğŸ“… å³å°†å¼€å§‹</text>
              <text class="subsection-count">{{upcomingMatches.length}}</text>
            </view>
            <view class="matches-list">
              <view
                wx:for="{{upcomingMatches}}"
                wx:key="id"
                class="match-card upcoming"
                bindtap="goToMatchDetail"
                data-id="{{item._id}}"
              >
                <view class="match-card-header">
                  <text class="match-type">{{item.eventType}}</text>
                  <text class="match-stage">{{item.stage}}</text>
                </view>
                <view class="match-players">
                  <view class="player-row">
                    <text class="player-name">{{item.players.team1[0].name}}</text>
                    <text class="player-ranking">{{item.players.team1[0].ranking ? '#' + item.players.team1[0].ranking : ''}}</text>
                  </view>
                  <view class="vs-divider">VS</view>
                  <view class="player-row">
                    <text class="player-name">{{item.players.team2[0].name}}</text>
                    <text class="player-ranking">{{item.players.team2[0].ranking ? '#' + item.players.team2[0].ranking : ''}}</text>
                  </view>
                </view>
                <view class="match-info">
                  <text class="venue">{{item.venue}}</text>
                  <text class="time">{{formatMatchTime(item.scheduledTime)}}</text>
                </view>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- å³ä¾§ï¼šç«çƒ­æŠ¥åå…¥å£åŒºåŸŸ -->
    <view class="hot-registration-section">
      <view class="section-header">
        <text class="section-title">ç«çƒ­æŠ¥å</text>
        <text class="section-subtitle">Hot Registration</text>
      </view>

      <!-- æŠ¥åå…¥å£å¡ç‰‡ -->
      <view class="registration-cards">
        <view
          wx:for="{{hotRegistrations}}"
          wx:key="id"
          class="registration-card"
          bindtap="goToEventDetail"
          data-id="{{item._id}}"
        >
          <view class="card-header">
            <view class="event-badge {{item.priority}}">
              <text class="badge-text">{{item.badgeText}}</text>
            </view>
            <view class="registration-status">
              <text class="status-text">{{item.registrationStatus}}</text>
            </view>
          </view>

          <view class="card-content">
            <text class="event-title">{{item.name}}</text>
            <text class="event-type">{{item.eventType}}</text>

            <view class="event-details">
              <view class="detail-row">
                <text class="detail-icon">ğŸ“</text>
                <text class="detail-text">{{item.venue}}</text>
              </view>
              <view class="detail-row">
                <text class="detail-icon">ğŸ“…</text>
                <text class="detail-text">{{formatEventDate(item.eventDate)}}</text>
              </view>
              <view class="detail-row">
                <text class="detail-icon">ğŸ‘¥</text>
                <text class="detail-text">{{item.participantCount}}/{{item.maxParticipants}}äºº</text>
              </view>
            </view>

            <view class="registration-info">
              <view class="deadline-info">
                <text class="deadline-label">æŠ¥åæˆªæ­¢:</text>
                <text class="deadline-date">{{formatDeadline(item.registrationDeadline)}}</text>
              </view>
              <view class="price-info" wx:if="{{item.price}}">
                <text class="price-label">è´¹ç”¨:</text>
                <text class="price-amount">Â¥{{item.price}}</text>
              </view>
            </view>
          </view>

          <view class="card-footer">
            <button class="register-btn {{item.canRegister ? 'active' : 'disabled'}}">
              {{item.registerButtonText}}
            </button>
          </view>
        </view>
      </view>

      <!-- æŸ¥çœ‹æ›´å¤šæŠ¥åæœºä¼š -->
      <view class="more-registrations" bindtap="showMoreRegistrations">
        <text class="more-text">æŸ¥çœ‹æ›´å¤šæŠ¥åæœºä¼š</text>
        <text class="more-icon">â†’</text>
      </view>
    </view>
  </view>

  <!-- Tab Content Container (ä¿ç•™åŸæœ‰çš„tabå†…å®¹ä½œä¸ºå¤‡ç”¨) -->
  <view
    class="tab-content-container hidden"
    bindtouchstart="onTouchStart"
    bindtouchmove="onTouchMove"
    bindtouchend="onTouchEnd"
  >
    
    <!-- Tab Content Component -->
    <tab-content 
      activeTab="{{activeTab}}"
      loading="{{loading}}"
      error="{{error}}"
      enableLazyLoad="{{true}}"
      enableCache="{{true}}"
      bindtabcontentchange="onTabContentChange"
      bindlazyload="onTabLazyLoad"
      bindretry="onTabRetry"
    >
      <!-- All Matches Tab Content -->
      <view slot="all-matches">
        <!-- Quick Stats Panel -->
        <view class="stats-panel" wx:if="{{matchStats}}">
          <view class="stats-item">
            <view class="stats-icon">ğŸ¾</view>
            <view class="stats-content">
              <text class="stats-number">{{matchStats.total}}</text>
              <text class="stats-label">æ€»æ¯”èµ›</text>
            </view>
          </view>
          <view class="stats-item">
            <view class="stats-icon">âš¡</view>
            <view class="stats-content">
              <text class="stats-number">{{matchStats.live}}</text>
              <text class="stats-label">è¿›è¡Œä¸­</text>
            </view>
          </view>
          <view class="stats-item">
            <view class="stats-icon">ğŸ†</view>
            <view class="stats-content">
              <text class="stats-number">{{matchStats.completed}}</text>
              <text class="stats-label">å·²å®Œæˆ</text>
            </view>
          </view>
        </view>

        <!-- Enhanced Filter Bar -->
        <view class="enhanced-filter-bar">
          <!-- Quick Filters -->
          <scroll-view class="quick-filters" scroll-x="true">
            <view class="quick-filter-items">
              <view
                wx:for="{{quickFilters}}"
                wx:key="id"
                class="quick-filter-item {{currentFilter === item.id ? 'active' : ''}}"
                bindtap="switchQuickFilter"
                data-filter="{{item.id}}"
              >
                <text class="filter-icon">{{item.icon}}</text>
                <text class="filter-text">{{item.name}}</text>
                <text wx:if="{{item.count}}" class="filter-count">{{item.count}}</text>
              </view>
            </view>
          </scroll-view>

          <!-- Advanced Filter Button -->
          <view class="advanced-filter-btn" bindtap="showAdvancedFilter">
            <text class="filter-icon">ğŸ”</text>
            <text class="filter-text">ç­›é€‰</text>
            <view wx:if="{{activeFiltersCount > 0}}" class="filter-badge">{{activeFiltersCount}}</view>
          </view>
        </view>

        <!-- Active Filters Display -->
        <view wx:if="{{activeFilters.length > 0}}" class="active-filters">
          <view class="active-filters-title">
            <text class="title-text">å½“å‰ç­›é€‰</text>
            <text class="clear-all" bindtap="clearAllFilters">æ¸…é™¤å…¨éƒ¨</text>
          </view>
          <view class="active-filter-tags">
            <view
              wx:for="{{activeFilters}}"
              wx:key="key"
              class="active-filter-tag"
              bindtap="removeFilter"
              data-key="{{item.key}}"
            >
              <text class="tag-text">{{item.label}}</text>
              <text class="tag-remove">âœ•</text>
            </view>
          </view>
        </view>

        <!-- Matches List -->
        <view class="matches-list">
          <view 
            wx:for="{{matches}}" 
            wx:key="id" 
            class="match-card {{item.status}}"
            bindtap="goToMatchDetail"
            data-id="{{item._id}}"
          >
            <!-- Match Header -->
            <view class="match-header">
              <view class="match-type">
                <text class="type-icon">{{getMatchTypeIcon(item.matchType)}}</text>
                <text class="type-text">{{item.matchType}}</text>
              </view>
              <view class="match-status status-{{item.status}}">
                {{getStatusText(item.status)}}
              </view>
            </view>

            <!-- Enhanced Players Section -->
            <view class="enhanced-players-section">
              <!-- Team 1 -->
              <view class="team-container team-left">
                <player-info
                  format="{{item.format || 'singles'}}"
                  layout="compact"
                  player="{{item.players.team1[0]}}"
                  players="{{item.players.team1}}"
                  showRanking="{{true}}"
                  bindplayertap="onPlayerTap"
                />
              </view>

              <!-- Match Center -->
              <view class="match-center-enhanced">
                <view wx:if="{{item.status === 'æŠ¥åä¸­'}}" class="vs-section">
                  <text class="vs-text">VS</text>
                  <text class="match-time">{{formatMatchTime(item.scheduledTime)}}</text>
                  <text class="event-type">{{item.eventType}}</text>
                </view>
                <view wx:else class="score-section-enhanced">
                  <view class="current-score">
                    <text class="score-team1">{{getTeamScore(item, 'team1')}}</text>
                    <text class="score-separator">:</text>
                    <text class="score-team2">{{getTeamScore(item, 'team2')}}</text>
                  </view>
                  <view wx:if="{{item.status === 'æ¯”èµ›ä¸­'}}" class="live-indicator">
                    <text class="live-dot"></text>
                    <text class="live-text">LIVE</text>
                  </view>
                  <view wx:if="{{item.scoreSummary && item.scoreSummary.sets.length > 0}}" class="sets-summary">
                    <text
                      wx:for="{{item.scoreSummary.sets}}"
                      wx:key="setNumber"
                      class="set-score"
                    >
                      {{item.team1Score}}-{{item.team2Score}}
                    </text>
                  </view>
                </view>
              </view>

              <!-- Team 2 -->
              <view class="team-container team-right">
                <player-info
                  format="{{item.format || 'singles'}}"
                  layout="compact"
                  player="{{item.players.team2[0]}}"
                  players="{{item.players.team2}}"
                  showRanking="{{true}}"
                  bindplayertap="onPlayerTap"
                />
              </view>
            </view>

            <!-- Match Info -->
            <view class="match-info">
              <view class="info-item">
                <text class="info-icon">ğŸ“</text>
                <text class="info-text">{{item.venue}}</text>
              </view>
              <view class="info-item" wx:if="{{item.tournament}}">
                <text class="info-icon">ğŸ†</text>
                <text class="info-text">{{item.tournament.name}}</text>
              </view>
              <view class="info-item" wx:if="{{item.round}}">
                <text class="info-icon">ğŸ¯</text>
                <text class="info-text">{{item.round}}</text>
              </view>
            </view>

            <!-- Quick Actions -->
            <view class="match-actions" wx:if="{{item.canInteract}}">
              <button 
                wx:if="{{item.status === 'live'}}" 
                class="action-btn watch-btn"
                catchtap="watchLive"
                data-id="{{item._id}}"
              >
                <text class="btn-icon">ğŸ‘ï¸</text>
                <text class="btn-text">è§‚çœ‹</text>
              </button>
              <button 
                wx:if="{{item.canScore}}" 
                class="action-btn score-btn"
                catchtap="updateScore"
                data-id="{{item._id}}"
              >
                <text class="btn-icon">ğŸ“</text>
                <text class="btn-text">è®°åˆ†</text>
              </button>
              <button 
                class="action-btn share-btn"
                catchtap="shareMatch"
                data-id="{{item._id}}"
              >
                <text class="btn-icon">ğŸ“¤</text>
                <text class="btn-text">åˆ†äº«</text>
              </button>
            </view>
          </view>
        </view>

        <!-- Loading More -->
        <view wx:if="{{tabData['all-matches'].loading && tabData['all-matches'].matches.length > 0}}" class="loading-more">
          <view class="loading-spinner"></view>
          <text class="loading-text">åŠ è½½ä¸­...</text>
        </view>

        <!-- Load More Button -->
        <view wx:if="{{tabData['all-matches'].hasMore && !tabData['all-matches'].loading}}" class="load-more" bindtap="loadMoreMatches">
          <text class="load-more-text">åŠ è½½æ›´å¤šæ¯”èµ›</text>
          <text class="load-more-icon">â¬‡ï¸</text>
        </view>

        <!-- No More Data -->
        <view wx:if="{{!tabData['all-matches'].hasMore && tabData['all-matches'].matches.length > 0}}" class="no-more-data">
          <text class="no-more-text">å·²åŠ è½½å…¨éƒ¨æ¯”èµ›</text>
          <text class="total-count">å…± {{tabData['all-matches'].total || tabData['all-matches'].matches.length}} åœº</text>
        </view>

        <!-- Empty State -->
        <view wx:if="{{!tabData['all-matches'].loading && tabData['all-matches'].matches.length === 0}}" class="empty-state">
          <text class="empty-icon">ğŸ¾</text>
          <view class="empty-text">æš‚æ— æ¯”èµ›æ•°æ®</view>
          <button class="empty-action" bindtap="refreshMatches">åˆ·æ–°</button>
        </view>

        <!-- Initial Loading -->
        <view wx:if="{{tabData['all-matches'].loading && tabData['all-matches'].matches.length === 0}}" class="initial-loading">
          <view class="loading-spinner large"></view>
          <text class="loading-text">æ­£åœ¨åŠ è½½æ¯”èµ›æ•°æ®...</text>
        </view>
      </view>
      
      <!-- Live Matches Tab Content -->
      <view slot="live-matches">
        <view class="live-matches-content">
          <!-- Live Match Header -->
          <view class="live-header">
            <view class="live-title">
              <text class="live-icon">ğŸ”´</text>
              <text class="live-text">æ­£åœ¨è¿›è¡Œçš„æ¯”èµ›</text>
            </view>
            <view class="live-count">{{liveMatches.length}} åœº</view>
          </view>

          <!-- Live Matches List -->
          <view wx:if="{{liveMatches.length > 0}}" class="live-matches-list">
            <view 
              wx:for="{{liveMatches}}" 
              wx:key="id" 
              class="live-match-card"
              bindtap="goToLiveMatch"
              data-id="{{item._id}}"
            >
              <!-- Live Indicator -->
              <view class="live-badge">
                <text class="live-pulse"></text>
                <text class="live-label">LIVE</text>
              </view>

              <!-- Match Title -->
              <view class="live-match-title">
                <text class="match-name">{{item.player1.name}} vs {{item.player2.name}}</text>
                <text class="match-round" wx:if="{{item.round}}">{{item.round}}</text>
              </view>

              <!-- Live Score -->
              <view class="live-score-display">
                <view class="score-row">
                  <text class="player-name-score">{{item.player1.name}}</text>
                  <view class="sets-score">
                    <text 
                      wx:for="{{item.score.sets}}" 
                      wx:key="index"
                      class="set-score {{item.player1Score > item.player2Score ? 'winner' : ''}}"
                    >
                      {{item.player1Score}}
                    </text>
                  </view>
                </view>
                <view class="score-row">
                  <text class="player-name-score">{{item.player2.name}}</text>
                  <view class="sets-score">
                    <text 
                      wx:for="{{item.score.sets}}" 
                      wx:key="index"
                      class="set-score {{item.player2Score > item.player1Score ? 'winner' : ''}}"
                    >
                      {{item.player2Score}}
                    </text>
                  </view>
                </view>
              </view>

              <!-- Match Progress -->
              <view class="match-progress">
                <text class="current-set">ç¬¬{{item.currentSet}}ç›˜</text>
                <text class="match-duration">{{formatDuration(item.duration)}}</text>
              </view>
            </view>
          </view>

          <!-- No Live Matches -->
          <view wx:else class="no-live-matches">
            <text class="no-live-icon">â¸ï¸</text>
            <view class="no-live-text">å½“å‰æ²¡æœ‰è¿›è¡Œä¸­çš„æ¯”èµ›</view>
            <button class="refresh-btn" bindtap="refreshLiveMatches">åˆ·æ–°</button>
          </view>
        </view>
      </view>
      
      <!-- My Matches Tab Content -->
      <view slot="my-matches">
        <view class="my-matches-content">
          <!-- My Matches Header -->
          <view class="my-matches-header">
            <view class="match-type-tabs">
              <view 
                class="type-tab {{myMatchType === 'all' ? 'active' : ''}}"
                bindtap="switchMyMatchType"
                data-type="all"
              >
                <text class="tab-icon">ğŸ“‹</text>
                <text class="tab-text">å…¨éƒ¨</text>
              </view>
              <view 
                class="type-tab {{myMatchType === 'upcoming' ? 'active' : ''}}"
                bindtap="switchMyMatchType"
                data-type="upcoming"
              >
                <text class="tab-icon">â°</text>
                <text class="tab-text">å³å°†å¼€å§‹</text>
              </view>
              <view 
                class="type-tab {{myMatchType === 'completed' ? 'active' : ''}}"
                bindtap="switchMyMatchType"
                data-type="completed"
              >
                <text class="tab-icon">âœ…</text>
                <text class="tab-text">å·²å®Œæˆ</text>
              </view>
            </view>
          </view>

          <!-- My Matches List -->
          <view wx:if="{{myMatches.length > 0}}" class="my-matches-list">
            <view 
              wx:for="{{myMatches}}" 
              wx:key="id" 
              class="my-match-card {{item.result}}"
              bindtap="goToMatchDetail"
              data-id="{{item._id}}"
            >
              <!-- Match Result Badge -->
              <view wx:if="{{item.status === 'completed'}}" class="result-badge {{item.result}}">
                <text class="result-icon">{{item.result === 'win' ? 'ğŸ†' : item.result === 'loss' ? 'ğŸ˜”' : 'ğŸ¤'}}</text>
                <text class="result-text">{{item.result === 'win' ? 'èƒœåˆ©' : item.result === 'loss' ? 'å¤±è´¥' : 'å¹³å±€'}}</text>
              </view>

              <!-- Opponent Info -->
              <view class="opponent-section">
                <view class="opponent-avatar">
                  <image 
                    class="opponent-img" 
                    src="{{item.opponent.avatar || '/images/default-avatar.png'}}"
                    mode="aspectFill"
                  />
                </view>
                <view class="opponent-info">
                  <text class="opponent-name">å¯¹æ‰‹: {{item.opponent.name}}</text>
                  <text class="match-date">{{formatDate(item.scheduledTime)}}</text>
                  <text class="match-venue">{{item.venue}}</text>
                </view>
              </view>

              <!-- Match Score Summary -->
              <view wx:if="{{item.status === 'completed'}}" class="score-summary">
                <text class="final-score">{{item.finalScore}}</text>
                <text class="match-duration">ç”¨æ—¶: {{formatDuration(item.duration)}}</text>
              </view>

              <!-- Quick Actions -->
              <view class="my-match-actions">
                <button 
                  wx:if="{{item.status === 'upcoming'}}" 
                  class="action-btn prepare-btn"
                  catchtap="prepareMatch"
                  data-id="{{item._id}}"
                >
                  <text class="btn-icon">ğŸ¯</text>
                  <text class="btn-text">å‡†å¤‡</text>
                </button>
                <button 
                  wx:if="{{item.status === 'completed'}}" 
                  class="action-btn review-btn"
                  catchtap="reviewMatch"
                  data-id="{{item._id}}"
                >
                  <text class="btn-icon">ğŸ“Š</text>
                  <text class="btn-text">å›é¡¾</text>
                </button>
                <button 
                  class="action-btn share-btn"
                  catchtap="shareMyMatch"
                  data-id="{{item._id}}"
                >
                  <text class="btn-icon">ğŸ“¤</text>
                  <text class="btn-text">åˆ†äº«</text>
                </button>
              </view>
            </view>
          </view>

          <!-- Empty My Matches -->
          <view wx:else class="empty-my-matches">
            <text class="empty-icon">ğŸ¾</text>
            <view class="empty-text">
              {{myMatchType === 'upcoming' ? 'æš‚æ— å³å°†å¼€å§‹çš„æ¯”èµ›' : 
                myMatchType === 'completed' ? 'æš‚æ— å·²å®Œæˆçš„æ¯”èµ›' : 'æš‚æ— æ¯”èµ›è®°å½•'}}
            </view>
          </view>
        </view>
      </view>
      
      <!-- Tournament Bracket Tab Content -->
      <view slot="tournament">
        <view class="tournament-content">
          <!-- Tournament Selector -->
          <view class="tournament-selector">
            <picker 
              bindchange="onTournamentChange" 
              value="{{selectedTournamentIndex}}" 
              range="{{tournaments}}" 
              range-key="name"
            >
              <view class="tournament-picker">
                <text class="tournament-icon">ğŸ†</text>
                <text class="tournament-name">{{selectedTournament.name || 'é€‰æ‹©é”¦æ ‡èµ›'}}</text>
                <text class="picker-arrow">â–¼</text>
              </view>
            </picker>
          </view>

          <!-- Tournament Info -->
          <view wx:if="{{selectedTournament}}" class="tournament-info">
            <view class="tournament-header">
              <view class="tournament-title">
                <text class="title-text">{{selectedTournament.name}}</text>
                <text class="tournament-status status-{{selectedTournament.status}}">
                  {{getTournamentStatusText(selectedTournament.status)}}
                </text>
              </view>
              <view class="tournament-details">
                <text class="detail-item">å‚èµ›äººæ•°: {{selectedTournament.participantCount}}</text>
                <text class="detail-item">æ¯”èµ›è½®æ¬¡: {{selectedTournament.currentRound}}</text>
              </view>
            </view>

            <!-- Bracket View -->
            <view class="bracket-container">
              <scroll-view class="bracket-scroll" scroll-x="true">
                <view class="bracket-rounds">
                  <view 
                    wx:for="{{bracketRounds}}" 
                    wx:key="round"
                    class="bracket-round"
                  >
                    <view class="round-header">
                      <text class="round-title">{{item.name}}</text>
                      <text class="round-matches">{{item.matches.length}} åœº</text>
                    </view>
                    
                    <view class="round-matches">
                      <view 
                        wx:for="{{item.matches}}" 
                        wx:key="id"
                        class="bracket-match {{item.status}}"
                        bindtap="goToBracketMatch"
                        data-id="{{item._id}}"
                      >
                        <!-- Player 1 -->
                        <view class="bracket-player {{item.winner === 'player1' ? 'winner' : ''}}">
                          <text class="player-name">{{item.player1.name}}</text>
                          <text class="player-score">{{item.score.player1}}</text>
                        </view>
                        
                        <!-- Player 2 -->
                        <view class="bracket-player {{item.winner === 'player2' ? 'winner' : ''}}">
                          <text class="player-name">{{item.player2.name}}</text>
                          <text class="player-score">{{item.score.player2}}</text>
                        </view>
                        
                        <!-- Match Status -->
                        <view class="bracket-status">
                          <text wx:if="{{item.status === 'live'}}" class="status-live">LIVE</text>
                          <text wx:elif="{{item.status === 'completed'}}" class="status-completed">âœ“</text>
                          <text wx:else class="status-scheduled">{{formatTime(item.scheduledTime)}}</text>
                        </view>
                      </view>
                    </view>
                  </view>
                </view>
              </scroll-view>
            </view>
          </view>

          <!-- No Tournament Selected -->
          <view wx:else class="no-tournament">
            <text class="no-tournament-icon">ğŸ†</text>
            <view class="no-tournament-text">è¯·é€‰æ‹©ä¸€ä¸ªé”¦æ ‡èµ›æŸ¥çœ‹å¯¹é˜µè¡¨</view>
          </view>
        </view>
      </view>
      
      <!-- Statistics Tab Content -->
      <view slot="statistics">
        <view class="statistics-content">
          <!-- Stats Overview -->
          <view class="stats-overview">
            <view class="overview-title">
              <text class="title-icon">ğŸ“Š</text>
              <text class="title-text">æ¯”èµ›ç»Ÿè®¡</text>
            </view>
            
            <view class="stats-grid">
              <view class="stat-card">
                <view class="stat-icon">ğŸ¾</view>
                <view class="stat-content">
                  <text class="stat-number">{{userStats.totalMatches}}</text>
                  <text class="stat-label">æ€»æ¯”èµ›</text>
                </view>
              </view>
              
              <view class="stat-card">
                <view class="stat-icon">ğŸ†</view>
                <view class="stat-content">
                  <text class="stat-number">{{userStats.wins}}</text>
                  <text class="stat-label">èƒœåˆ©</text>
                </view>
              </view>
              
              <view class="stat-card">
                <view class="stat-icon">ğŸ“ˆ</view>
                <view class="stat-content">
                  <text class="stat-number">{{userStats.winRate}}%</text>
                  <text class="stat-label">èƒœç‡</text>
                </view>
              </view>
              
              <view class="stat-card">
                <view class="stat-icon">â­</view>
                <view class="stat-content">
                  <text class="stat-number">{{userStats.ranking}}</text>
                  <text class="stat-label">æ’å</text>
                </view>
              </view>
            </view>
          </view>

          <!-- Performance Chart -->
          <view class="performance-section">
            <view class="section-title">
              <text class="title-text">è¿‘æœŸè¡¨ç°</text>
              <view class="time-filter">
                <text 
                  class="filter-option {{statsTimeRange === '7d' ? 'active' : ''}}"
                  bindtap="switchStatsTimeRange"
                  data-range="7d"
                >
                  7å¤©
                </text>
                <text 
                  class="filter-option {{statsTimeRange === '30d' ? 'active' : ''}}"
                  bindtap="switchStatsTimeRange"
                  data-range="30d"
                >
                  30å¤©
                </text>
                <text 
                  class="filter-option {{statsTimeRange === '90d' ? 'active' : ''}}"
                  bindtap="switchStatsTimeRange"
                  data-range="90d"
                >
                  90å¤©
                </text>
              </view>
            </view>
            
            <!-- Simple Performance Bars -->
            <view class="performance-bars">
              <view 
                wx:for="{{performanceData}}" 
                wx:key="date"
                class="performance-bar"
              >
                <view class="bar-date">{{item.date}}</view>
                <view class="bar-container">
                  <view 
                    class="bar-fill {{item.result}}"
                    style="width: {{item.percentage}}%"
                  ></view>
                </view>
                <view class="bar-result">{{item.result === 'win' ? 'W' : item.result === 'loss' ? 'L' : 'D'}}</view>
              </view>
            </view>
          </view>

          <!-- Match Type Stats -->
          <view class="match-type-stats">
            <view class="section-title">
              <text class="title-text">æ¯”èµ›ç±»å‹ç»Ÿè®¡</text>
            </view>
            
            <view class="type-stats-list">
              <view 
                wx:for="{{matchTypeStats}}" 
                wx:key="type"
                class="type-stat-item"
              >
                <view class="type-info">
                  <text class="type-icon">{{item.icon}}</text>
                  <text class="type-name">{{item.name}}</text>
                </view>
                <view class="type-numbers">
                  <text class="type-matches">{{item.matches}}åœº</text>
                  <text class="type-winrate">èƒœç‡{{item.winRate}}%</text>
                </view>
              </view>
            </view>
          </view>
        </view>
      </view>
      
    </tab-content>

  </view> <!-- End of tab-content-container -->

  <!-- Advanced Match Filter Component -->
  <match-filter
    showFilter="{{showAdvancedFilter}}"
    initialFilters="{{currentFilters}}"
    bindfilterchange="onFilterChange"
    bindclose="hideAdvancedFilter"
  ></match-filter>
</view>