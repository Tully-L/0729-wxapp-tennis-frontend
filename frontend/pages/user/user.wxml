<!-- user.wxml -->
<view class="page-container">
  <!-- æœªç™»å½•çŠ¶æ€ - è·³è½¬åˆ°ç™»å½•é¡µé¢ -->
  <view wx:if="{{!isLoggedIn}}" class="login-prompt">
    <view class="prompt-content">
      <view class="prompt-icon">ğŸ‘¤</view>
      <view class="prompt-title">è¯·å…ˆç™»å½•</view>
      <view class="prompt-subtitle">ç™»å½•åå¯æŸ¥çœ‹ä¸ªäººä¿¡æ¯å’Œèµ›äº‹è®°å½•</view>
      <button class="login-btn" bindtap="goToLogin">ç«‹å³ç™»å½•</button>
    </view>
  </view>

  <!-- å·²ç™»å½•çŠ¶æ€ - æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯ -->
  <view wx:else class="logged-in-container">
    <!-- é¡¶éƒ¨èƒŒæ™¯ä¸å¤´åƒä¿¡æ¯åŒº -->
    <view class="top-info-section">
      <view class="top-bg"></view>
      <view class="user-profile">
        <!-- å¤´åƒ -->
        <view class="user-avatar">
          <image wx:if="{{userInfo.avatarUrl}}" src="{{userInfo.avatarUrl}}" class="avatar-image" mode="aspectFill"></image>
          <view wx:else class="default-avatar"></view>
        </view>
        <!-- ç”¨æˆ·ä¿¡æ¯ -->
        <view class="user-details">
          <text class="user-name">{{userInfo.nickName || userInfo.nickname || 'ç½‘çƒé€‰æ‰‹'}}</text>
          <text class="user-uid">UID: {{profile.customId || profile.id || userInfo.id || '86594010'}}</text>
          <text class="user-info">{{profile.age ? profile.age + 'å²' : '-'}} | ä½“é‡{{profile.weight || '-'}} | çƒé¾„{{profile.experience || '-'}} | æŒæ‹æ‰‹{{profile.hand || '-'}}</text>
        </view>
        <!-- æ“ä½œæŒ‰é’®åŒº -->
        <view class="action-buttons">
          <view class="edit-btn" bindtap="editProfile">
            <text class="btn-text">ä¿®æ”¹</text>
          </view>
          <view class="logout-btn" bindtap="logout">
            <text class="btn-text">é€€å‡º</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æ¬¢è¿è¯­ä¸åŠŸèƒ½å¿«æ·å…¥å£åŒº -->
    <view class="welcome-section">
      <!-- æ¬¢è¿è¯­ -->
      <view class="welcome-bar">
        <text class="welcome-text">å—¨ï¼Œæ¬¢è¿åŠ å…¥LJç½‘çƒç¤¾ï¼Œè®°å½•åŠªåŠ›å’Œç²¾å½©</text>
      </view>
      <!-- åŠŸèƒ½å¿«æ·å…¥å£ -->
      <view class="quick-actions">
        <view class="action-item" bindtap="goToOrders">
          <view class="action-icon order-icon"></view>
          <text class="action-text">è®¢å•</text>
        </view>
        <view class="action-item" bindtap="goToMessages">
          <view class="action-icon message-icon"></view>
          <text class="action-text">æ¶ˆæ¯</text>
        </view>
        <view class="action-item" bindtap="goToCustomerService">
          <view class="action-icon service-icon"></view>
          <text class="action-text">å®¢æœ</text>
        </view>
        <view class="action-item" bindtap="goToSettings">
          <view class="action-icon settings-icon"></view>
          <text class="action-text">è®¾ç½®</text>
        </view>
      </view>
    </view>

    <!-- ä¸šåŠ¡æ¨¡å—åŒº -->
    <view class="business-modules">
      <view class="module-row">
        <view class="module-item mdou-module" bindtap="goToMDou">
          <view class="module-icon mdou-icon"></view>
          <view class="module-content">
            <text class="module-title">Mè±†</text>
            <text class="module-value">{{userStats.mDou || 0}}</text>
          </view>
        </view>
        <view class="module-item coupon-module" bindtap="goToCoupons">
          <view class="module-icon coupon-icon"></view>
          <view class="module-content">
            <text class="module-title">ä¼˜æƒ åˆ¸</text>
            <text class="module-value">{{userStats.coupons || 0}}å¼ </text>
          </view>
        </view>
      </view>
      <view class="module-row">
        <view class="module-item events-module" bindtap="goToMyEvents">
          <view class="module-icon events-icon"></view>
          <view class="module-content">
            <text class="module-title">æˆ‘çš„èµ›äº‹</text>
            <text class="module-value">{{userStats.events || 0}}åœº</text>
          </view>
        </view>
        <view class="module-item member-module" bindtap="goToMemberCenter">
          <view class="module-icon member-icon"></view>
          <view class="module-content">
            <text class="module-title">ä¼šå‘˜ä¸­å¿ƒ</text>
            <text class="module-value">{{userStats.memberLevel || 'VIP'}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æˆ‘çš„èµ›äº‹è®°å½•åŒº -->
    <view class="events-record-section">
      <view class="section-title">æˆ‘çš„èµ›äº‹è®°å½•</view>
      <view class="events-list">
        <!-- è¿™é‡Œå¯ä»¥æ·»åŠ èµ›äº‹è®°å½•åˆ—è¡¨ -->
        <view class="empty-events">æš‚æ— èµ›äº‹è®°å½•</view>
        <!-- ä¸‹æ–¹ç™½è‰²åŒºåŸŸ -->
        <view class="bottom-white-space"></view>
      </view>
    </view>
  </view>
</view>